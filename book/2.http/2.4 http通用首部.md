# 2.4 http通用首部详解

| 字段 | 描述 | 备注  |
| --  |  --  |  --   |
|  Connection        |       允许客户端和服务器指定与请求/响应连接有关的选项                              | -- |
|  Date              |       提供了日期的时间标志，说明报文是什么时间创建的                               | -- |
|  MIME-Version      |       给出了发送端使用的MIME版本                                                 | -- |
|  Trailer           |       如果报文采用了分块传输编码方式，就可以用这个首部列出位于报文拖挂部分的首部集合  | -- |
|  Transfer-Encoding |       告知接收端为了保证报文的可靠传输，对报文采用了什么编码方式                    | -- |
|  Update            |       给出了发送端可能想要“升级”使用的新版本或协议                                 | -- |
|  Via               |       显示了报文经过的中间节点（代理、网关）                                      |  -- |
|  Cache-Control     |       用于随报文传送缓存指示                                                     | 用于缓存|
|  Pragma            |       报文指令                                                                  | 用于缓存|

### `Connection`

`Connection` 首部字段具备如下两个作用。 
- 控制不再转发给代理的首部字段      
- 管理持久连接

`connection`的值默认是`keep-alive`，开启`HTTP`持久连接（ 对于同一个域名,只有最开始的2到6个请求需要建立`TCP`连接, 那之后, 已存在的连接会被复用）。

我们通过`Chrome`浏览器开发者工具`network`栏中的瀑布流可以看到具体的信息。

比如我们使用默认的`keep-alive`。这时候在多次请求同一个域名。

![](../images/2.4%20connect-keepAlive瀑布流.png)


图中的橙色部分就是`tcp`连接耗时，可以看到并非全部请求都有进行`tcp`的握手连接。设置了`keep-alive`后`tcp`连接并未断开，图中不同颜色的线标记了复用的`tcp`。

设置`close`后

![](../images/2.4%20connect-close瀑布流.png)

可以发现所有的请求都带有橙色部分，就是每个请求都重新建立了`tcp`连接。

> 需要注意的在浏览器上不能设置`Connection:close`，会出现`Refused to set unsafe header "Connection"`错误，是因为`XMLHttpRequest`不允许设置这些标题，它们是由浏览器自动设置的。原因在于，通过操纵这些标头，可能会欺骗服务器通过相同的连接接受第二个请求，而这种连接不会经过通常的安全检查 - 这将成为浏览器中的安全漏洞。

